import{c as w,j as e,B as m}from"./config.sbWlfyv2.js";import{r}from"./index.BVn2TZg3.js";import{c as f,d as L,e as z,f as F,S as R,A as U,a as O,b as V}from"./site-header.B3j0ufG-.js";import{C as b,b as S,c as _,d as q,a as H,e as Q}from"./card.DSskY0du.js";import{B as l}from"./badge.B4J_ClHX.js";import{A as W,a as J,b as K}from"./alert.CrxqG8Ya.js";import{I as X}from"./IconLoader.C_yaBtwI.js";import{I as Y}from"./IconCheck.Bps8dZO5.js";import{I as Z}from"./IconAlertCircle.DVcUbgx8.js";import{I as k}from"./IconCalendar.Dwwf9MVY.js";import{I as ee}from"./IconUsers.DeQb-pHz.js";import{I as se}from"./IconClock.D5b6adtJ.js";import"./createLucideIcon.Cw3puCNq.js";/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M5 12l6 6",key:"svg-1"}],["path",{d:"M5 12l6 -6",key:"svg-2"}]],te=f("outline","arrow-left","ArrowLeft",ae);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z",key:"svg-0"}]],ne=f("outline","moon","Moon",re);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7",key:"svg-1"}]],le=f("outline","sun","Sun",oe);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M3 17h1m16 0h1m-15.4 -6.4l.7 .7m12.1 -.7l-.7 .7m-9.7 5.7a4 4 0 0 1 8 0",key:"svg-0"}],["path",{d:"M3 21l18 0",key:"svg-1"}],["path",{d:"M12 3v6l3 -3m-6 0l3 3",key:"svg-2"}]],ie=f("outline","sunset","Sunset",ce);function de({token:c}){const[j,u]=r.useState(!0),[n,g]=r.useState(null),[i,h]=r.useState([]),[p,A]=r.useState(null),[d,x]=r.useState(null),[y,C]=r.useState(null);r.useEffect(()=>{if(typeof window<"u"){const t=new URLSearchParams(window.location.search).get("courseId");A(t),t&&E(t)}},[]);const E=async s=>{u(!0);try{const t=c?.replace(/^"|"$/g,""),v=await fetch(`${w.apiUrl}${w.endpoints.courses.getGroups}`.replace(":id",s),{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!v.ok)throw new Error("Error cargando grupos");const o=await v.json();console.log("Response data:",o);const B=Array.isArray(o)?o:o.groups||[],P=o.course_title;g({id:parseInt(s),name:P||"Curso sin nombre",description:"Descripción no disponible",image:"/academico/images/9440461.webp",level:"Intermedio",duration:"Duración no especificada"});const I=B.map(a=>({id:a.group_id,code:a.group_code,name:a.group_name,start_date:a.start_date,end_date:a.end_date,teacher:{id:a.teacher?.id||1,name:a.teacher?.full_name||"Instructor",photo:a.teacher?.profile_photo||"/academico/images/9440461.webp"},available_spots:a.available_spots||(a.students?Math.max(0,25-a.students.length):0),total_spots:a.total_spots||25,status:a.status==="full"?"full":a.status==="open"?"available":"upcoming",enrolled:a.enrolled||!1}));console.log("Grupos procesados:",I),h(I)}catch(t){console.error("Error cargando datos:",t),x({type:"error",text:"Error al cargar los grupos. Por favor, intenta nuevamente."})}finally{u(!1)}},G=async s=>{if(window.confirm("¿Estás seguro de que deseas terminar este grupo?")){C(s);try{const t=c?.replace(/^"|"$/g,"");if(!(await fetch(`${w.apiUrl}/api/groups/${s}/complete`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}})).ok)throw new Error("Error al terminar el grupo");x({type:"success",text:"Grupo terminado exitosamente"}),h(i.map(o=>o.id===s?{...o,status:"completed",enrolled:!1}:o)),setTimeout(()=>x(null),3e3)}catch(t){console.error("Error terminando grupo:",t),x({type:"error",text:"Error al terminar el grupo. Por favor, intenta nuevamente."})}finally{C(null)}}},N=()=>{typeof window<"u"&&(window.location.href="/academico/dashboard/catalogo")},$=s=>{typeof window<"u"&&(window.location.href=`/academico/dashboard/informacion-grupos?groupId=${s}&courseId=${p}`)},D=s=>{switch(s){case"morning":return e.jsx(le,{className:"h-5 w-5"});case"afternoon":return e.jsx(ie,{className:"h-5 w-5"});case"night":return e.jsx(ne,{className:"h-5 w-5"});default:return e.jsx(se,{className:"h-5 w-5"})}},M=s=>{switch(s){case"morning":return"bg-amber-500/10 text-amber-500 border-amber-500/20";case"afternoon":return"bg-orange-500/10 text-orange-500 border-orange-500/20";case"night":return"bg-blue-500/10 text-blue-500 border-blue-500/20";default:return"bg-gray-500/10 text-gray-500 border-gray-500/20"}},T=s=>{switch(s){case"available":return e.jsx(l,{variant:"default",className:"bg-green-500/10 text-green-500 border-green-500/20",children:"Disponible"});case"full":return e.jsx(l,{variant:"secondary",className:"bg-red-500/10 text-red-500 border-red-500/20",children:"Completo"});case"upcoming":return e.jsx(l,{variant:"outline",children:"Próximamente"});case"completed":return e.jsx(l,{variant:"outline",className:"bg-gray-500/10 text-gray-500 border-gray-500/20",children:"Terminado"});default:return null}};return j?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx(X,{className:"h-8 w-8 animate-spin text-primary"})}):n?e.jsxs("div",{className:"w-full space-y-6 p-4 md:p-6",children:[d&&e.jsxs(W,{variant:d.type==="error"?"destructive":"default",className:"mb-6",children:[d.type==="success"?e.jsx(Y,{className:"h-4 w-4"}):e.jsx(Z,{className:"h-4 w-4"}),e.jsx(J,{children:d.type==="success"?"¡Éxito!":"Error"}),e.jsx(K,{children:d.text})]}),e.jsxs(m,{variant:"ghost",onClick:N,className:"gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),"Volver al Catálogo"]}),e.jsx(b,{className:"overflow-hidden",children:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsx("div",{className:"relative w-full md:w-80 h-64 md:h-auto flex-shrink-0",children:e.jsx("img",{src:n.image,alt:n.name,className:"w-full h-full object-cover"})}),e.jsx("div",{className:"flex-1",children:e.jsx(S,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(l,{variant:"outline",children:n.level}),e.jsx(l,{variant:"secondary",children:n.duration})]}),e.jsx(_,{className:"text-2xl md:text-3xl",children:n.name}),e.jsx(q,{className:"text-sm md:text-base leading-relaxed",children:n.description})]})})})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Grupos Disponibles"}),e.jsx("p",{className:"text-muted-foreground",children:"Selecciona el grupo que mejor se ajuste a tu horario"})]}),i.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(s=>e.jsxs(b,{className:`overflow-hidden hover:shadow-lg transition-all group ${s.status==="full"||s.status==="completed"?"opacity-60":"cursor-pointer"}`,children:[e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx(_,{className:"text-xl group-hover:text-primary transition-colors",children:s.name}),T(s.status)]}),s.shift&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(l,{className:M(s.shift),children:[D(s.shift),e.jsx("span",{className:"ml-2 capitalize",children:s.shift==="morning"?"Mañana":s.shift==="afternoon"?"Tarde":"Noche"})]})})]}),e.jsxs(H,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-muted-foreground",children:["Inicio: ",new Date(s.start_date).toLocaleDateString("es-PE")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-muted-foreground",children:["Fin: ",new Date(s.end_date).toLocaleDateString("es-PE")]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-2 border-t",children:[e.jsxs(L,{className:"h-10 w-10",children:[e.jsx(z,{src:s.teacher.photo}),e.jsx(F,{children:s.teacher.name.split(" ").map(t=>t[0]).join("")})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.teacher.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Instructor"})]})]}),e.jsxs("div",{className:"space-y-2 pt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ee,{className:"h-4 w-4"}),"Cupos disponibles"]}),e.jsxs("span",{className:"font-semibold",children:[s.available_spots,"/",s.total_spots]})]}),e.jsx("div",{className:"w-full bg-secondary rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${s.status==="full"?"bg-red-500":"bg-primary"}`,style:{width:`${(s.total_spots-s.available_spots)/s.total_spots*100}%`}})})]})]}),e.jsxs(Q,{className:"gap-2 flex-wrap",children:[s.status!=="completed"&&e.jsx(m,{variant:"destructive",className:"flex-1",onClick:()=>G(s.id),disabled:y===s.id,size:"sm",children:y===s.id?"Terminando...":"Terminar Grupo"}),e.jsx(m,{className:s.status!=="completed"?"flex-1":"w-full",disabled:s.status==="full"||s.status==="completed",onClick:()=>s.status!=="full"&&s.status!=="completed"&&$(s.id),size:"sm",children:s.status==="full"?"Grupo Completo":s.status==="completed"?"Terminado":"Ver Detalles del Grupo"})]})]},s.id))}):e.jsx(b,{className:"p-12",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h3",{className:"text-2xl font-semibold",children:"No hay grupos disponibles"}),e.jsx("p",{className:"text-muted-foreground",children:"Actualmente no hay grupos programados para este curso."}),e.jsx(m,{onClick:N,children:"Explorar Otros Cursos"})]})})]}):e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-muted-foreground",children:"No se pudo cargar el curso"}),e.jsx(m,{onClick:N,children:"Volver al Catálogo"})]})})}function Ce(){const[c,j]=r.useState(null),[u,n]=r.useState(null),[g,i]=r.useState(!1);return r.useEffect(()=>{const h=window.localStorage.getItem("token"),p=window.localStorage.getItem("user");j(h??null);try{n(p?JSON.parse(p):null)}catch{n(null)}i(!0)},[]),g?e.jsxs(R,{style:{"--sidebar-width":"calc(var(--spacing) * 72)","--header-height":"calc(var(--spacing) * 12)"},children:[e.jsx(U,{variant:"inset",token:c,user:u}),e.jsxs(O,{children:[e.jsx(V,{title:"Grupos Disponibles"}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx("div",{className:"@container/main flex flex-1 flex-col gap-2",children:e.jsx(de,{token:c})})})]})]}):null}export{Ce as default};
