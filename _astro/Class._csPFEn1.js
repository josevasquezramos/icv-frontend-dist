import{j as e,B as z,c as h}from"./config.DA722Lej.js";import{r as l}from"./index.BVn2TZg3.js";import{B as W,S as J,A as Q,a as q,b as Y}from"./site-header.CcIO_pl4.js";import{C as I,b as k,c as D,d as _,a as K}from"./card.BSoSeF1_.js";import{A as Z,b as ee}from"./alert.O9yGhm7j.js";import{B as x}from"./badge.FyzJaTHz.js";import{V as b,I as se}from"./video.BZwMdyWj.js";import{F as g,a as f,P as L,C as te,L as ae}from"./presentation.D3ckMBOr.js";import{C as re,a as le}from"./clock.DgRlrvGp.js";import{E as P}from"./external-link.BDH-xG-P.js";import{D as ne,a as oe,b as ie,c as ce}from"./dialog.FtcbSCI6.js";import{c as $}from"./createLucideIcon.Cw3puCNq.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],w=$("link-2",de);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],ue=$("play",me),pe=s=>new Date(s).toLocaleDateString("es-ES",{day:"2-digit",month:"long",year:"numeric"}),C=s=>new Date(s).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),E=s=>{const t={SCHEDULED:"bg-blue-500/10 text-blue-500 border-blue-500/20",IN_PROGRESS:"bg-green-500/10 text-green-500 border-green-500/20",COMPLETED:"bg-gray-500/10 text-gray-500 border-gray-500/20",CANCELLED:"bg-red-500/10 text-red-500 border-red-500/20"};return t[s]||t.SCHEDULED},S=s=>({SCHEDULED:"Programada",IN_PROGRESS:"En Progreso",COMPLETED:"Completada",CANCELLED:"Cancelada"})[s]||s,j=s=>{try{const n=new URL(s).pathname.split("/").pop()||s;return decodeURIComponent(n)}catch{return s}},xe=s=>{const t=s.toUpperCase();return t==="VIDEO"?e.jsx(b,{className:"h-5 w-5"}):t==="PDF"?e.jsx(g,{className:"h-5 w-5"}):t==="DOCX"||t==="DOC"?e.jsx(f,{className:"h-5 w-5"}):t==="XLSX"||t==="XLS"?e.jsx(f,{className:"h-5 w-5"}):t==="PPTX"||t==="PPT"?e.jsx(L,{className:"h-5 w-5"}):t==="IMAGEN"||t==="JPG"||t==="PNG"?e.jsx(se,{className:"h-5 w-5"}):e.jsx(W,{className:"h-5 w-5"})},he=s=>s.includes("youtube.com")||s.includes("youtu.be")||s.includes("vimeo.com")||s.match(/\.(mp4|webm|ogg)$/i)!==null,ge=s=>s.includes("youtube.com/watch?v=")?`https://www.youtube.com/embed/${s.split("v=")[1]?.split("&")[0]}`:s.includes("youtu.be/")?`https://www.youtube.com/embed/${s.split("youtu.be/")[1]?.split("?")[0]}`:s.includes("vimeo.com/")?`https://player.vimeo.com/video/${s.split("vimeo.com/")[1]?.split("?")[0]}`:s,fe=s=>s.includes("youtube.com/watch?v=")?`https://img.youtube.com/vi/${s.split("v=")[1]?.split("&")[0]}/maxresdefault.jpg`:s.includes("youtu.be/")?`https://img.youtube.com/vi/${s.split("youtu.be/")[1]?.split("?")[0]}/maxresdefault.jpg`:null,je=({classData:s,mainImage:t})=>e.jsxs(I,{className:"border-2 overflow-hidden",children:[t&&e.jsxs("div",{className:"relative w-full h-64 md:h-80 lg:h-96 bg-gradient-to-br from-primary/10 to-primary/5",children:[e.jsx("img",{src:t.material_url,alt:"Imagen de la clase",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx(x,{className:`${E(s.class_status)} text-sm px-4 py-1.5`,children:S(s.class_status)})})]}),e.jsxs(k,{className:"space-y-4 p-6 lg:p-8",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx(D,{className:"text-3xl lg:text-4xl leading-tight",children:s.class_name}),!t&&e.jsx(x,{className:E(s.class_status),children:S(s.class_status)})]}),s.description&&e.jsx(_,{className:"text-base lg:text-lg leading-relaxed",children:s.description})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 pt-4 border-t",children:[e.jsxs("div",{className:"flex flex-wrap gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(re,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Fecha"}),e.jsx("span",{className:"text-sm font-medium",children:pe(s.class_date)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(le,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Horario"}),e.jsxs("span",{className:"text-sm font-medium",children:[C(s.start_time)," - ",C(s.end_time)]})]})]})]}),s.meeting_url&&e.jsx(z,{asChild:!0,size:"lg",className:"gap-2 bg-green-600 hover:bg-green-700 md:min-w-[200px]",children:e.jsxs("a",{href:s.meeting_url,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(b,{className:"h-4 w-4"}),"Unirse a la Reunión",e.jsx(P,{className:"h-3 w-3"})]})})]})]})]}),be=({videos:s})=>{const[t,d]=l.useState(null);return s.length===0?null:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx(b,{className:"h-5 w-5 text-red-500"}),e.jsx("h3",{className:"font-semibold text-lg",children:"Videos"}),e.jsx(x,{variant:"outline",children:s.length})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(n=>{const m=fe(n.material_url);return e.jsxs("button",{onClick:()=>d(n),className:"group relative aspect-video rounded-lg overflow-hidden border-2 hover:border-primary transition-all bg-muted",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent z-10"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-20",children:e.jsx("div",{className:"bg-primary rounded-full p-4 group-hover:scale-110 transition-transform",children:e.jsx(ue,{className:"h-8 w-8 text-primary-foreground fill-current"})})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 z-20",children:e.jsx("p",{className:"text-white font-medium text-sm line-clamp-2",children:j(n.material_url)})}),m&&e.jsx("img",{src:m,alt:"Video thumbnail",className:"absolute inset-0 w-full h-full object-cover"})]},n.id)})})]}),e.jsx(ne,{open:!!t,onOpenChange:()=>d(null),children:e.jsxs(oe,{className:"max-w-4xl w-full p-0",children:[e.jsx(ie,{className:"p-6 pb-0",children:e.jsx(ce,{className:"pr-8",children:t&&j(t.material_url)})}),e.jsx("div",{className:"aspect-video w-full bg-black",children:t&&he(t.material_url)?e.jsx("iframe",{src:ge(t.material_url),className:"w-full h-full",allowFullScreen:!0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"}):e.jsx("video",{src:t?.material_url,controls:!0,className:"w-full h-full"})})]})})]})},Ne=({materials:s,type:t,label:d,icon:n,color:m})=>{const u=s.filter(r=>r.type.toUpperCase()===t.toUpperCase());return u.length===0?null:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx(n,{className:`h-5 w-5 ${m}`}),e.jsx("h3",{className:"font-semibold text-lg",children:d}),e.jsx(x,{variant:"outline",children:u.length})]}),e.jsx("div",{className:"space-y-2",children:u.map(r=>e.jsxs("a",{href:r.material_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 rounded-lg border hover:bg-muted/50 transition-colors group",children:[e.jsx("div",{className:"p-2 bg-muted rounded-lg flex-shrink-0",children:xe(r.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate text-sm",children:j(r.material_url)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(r.created_at).toLocaleDateString("es-ES")})]}),e.jsx(P,{className:"h-4 w-4 text-muted-foreground group-hover:text-primary transition-colors flex-shrink-0"})]},r.id))})]})};function Ae(){const[s,t]=l.useState(null),[d,n]=l.useState(null),[m,u]=l.useState(!1),[r,A]=l.useState(null),[ye,U]=l.useState(null),[N,T]=l.useState(null),[c,O]=l.useState([]),[V,y]=l.useState(!0),[v,F]=l.useState(null);l.useEffect(()=>{const a=window.localStorage.getItem("token"),o=window.localStorage.getItem("user");t(a??null);try{n(o?JSON.parse(o):null)}catch{n(null)}u(!0)},[]),l.useEffect(()=>{if(typeof window>"u")return;const a=new URLSearchParams(window.location.search),o=a.get("classId"),i=a.get("groupId");A(o),U(i)},[]),l.useEffect(()=>{r&&s&&(M(),B())},[r,s]);const M=async()=>{try{const a=s?.replace(/^"|"$/g,""),o=await fetch(`${h.apiUrl}/api/classes/${r}`,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!o.ok)throw new Error("Error al cargar la clase");const i=await o.json();T(i.data||i)}catch(a){F("Error al cargar los datos de la clase"),console.error(a)}},B=async()=>{y(!0);try{const a=s?.replace(/^"|"$/g,""),o=`${h.apiUrl}${h.endpoints.materials.getByClass}`.replace(":classId",r),i=await fetch(o,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!i.ok)throw new Error("Error al cargar materiales");const p=await i.json();O(Array.isArray(p.data)?p.data:[])}catch(a){console.error(a)}finally{y(!1)}},G=c.find(a=>a.type.toUpperCase()==="IMAGEN")||null,H=c.filter(a=>a.type.toUpperCase()==="VIDEO"),R=c.filter(a=>!["IMAGEN","VIDEO"].includes(a.type.toUpperCase())),X=[{key:"PDF",label:"Documentos PDF",icon:g,color:"text-purple-500"},{key:"DOCX",label:"Documentos Word",icon:f,color:"text-blue-500"},{key:"PPTX",label:"Presentaciones",icon:L,color:"text-orange-500"},{key:"XLSX",label:"Documento de Excel",icon:w,color:"text-cyan-500"},{key:"ENLACE",label:"Enlaces",icon:w,color:"text-cyan-500"}];return!m||!r?null:e.jsxs(J,{style:{"--sidebar-width":"calc(var(--spacing) * 72)","--header-height":"calc(var(--spacing) * 12)"},children:[e.jsx(Q,{variant:"inset",token:s,user:d}),e.jsxs(q,{children:[e.jsx(Y,{title:"Vista de Clase"}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx("div",{className:"@container/main flex flex-1 flex-col gap-2",children:e.jsxs("div",{className:"flex flex-col gap-6 py-4 md:py-6 px-4 md:px-6 lg:px-10",children:[v&&e.jsxs(Z,{variant:"destructive",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx(ee,{children:v})]}),N&&e.jsxs(e.Fragment,{children:[e.jsx(je,{classData:N,mainImage:G}),e.jsxs(I,{children:[e.jsxs(k,{children:[e.jsx(D,{children:"Materiales de la Clase"}),e.jsx(_,{children:c.length===0?"No hay materiales disponibles":`${c.length} material${c.length!==1?"es":""} disponible${c.length!==1?"s":""}`})]}),e.jsx(K,{className:"space-y-6",children:V?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ae,{className:"h-8 w-8 animate-spin text-primary"})}):c.length===0?e.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[e.jsx(g,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Aún no hay materiales cargados para esta clase"})]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{videos:H}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:X.map(({key:a,label:o,icon:i,color:p})=>e.jsx(Ne,{materials:R,type:a,label:o,icon:i,color:p},a))})]})})]})]})]})})})]})]})}export{Ae as default};
