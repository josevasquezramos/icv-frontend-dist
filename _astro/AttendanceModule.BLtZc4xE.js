import{j as e,B as A}from"./config.DA722Lej.js";import{r as t}from"./index.BVn2TZg3.js";import{c as q,d as Q,e as Y,f as Z,S as ee,A as se,a as ae,b as te}from"./site-header.CcIO_pl4.js";import{C as c,b as v,c as y,a as m,d as F}from"./card.BSoSeF1_.js";import{A as ne,a as re,b as ce}from"./alert.O9yGhm7j.js";import{S as U,a as H,b as V,c as O,d as $}from"./select.KVc0F5mA.js";import{I as W}from"./IconLoader.CpSXqs7V.js";import{I as le}from"./IconCheck.CXf9P-ea.js";import{I as ie}from"./IconAlertCircle.CnD7sKOg.js";import{I as J}from"./IconUsers.C-x-aE1c.js";import{I as E}from"./IconClock.DGc1Ztyo.js";import{B}from"./badge.FyzJaTHz.js";import{P as de}from"./progress.CPUoIT4Q.js";import{I as oe}from"./IconCalendar.DYjqBcxp.js";import{I as me}from"./IconPercentage.DEYD7Vfi.js";import"./createLucideIcon.Cw3puCNq.js";/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M9 11l3 3l8 -8",key:"svg-0"}],["path",{d:"M20 12v6a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h9",key:"svg-1"}]],ue=q("outline","checkbox","Checkbox",xe);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4",key:"svg-1"}],["path",{d:"M15 19l2 2l4 -4",key:"svg-2"}]],k=q("outline","user-check","UserCheck",he);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h3.5",key:"svg-1"}],["path",{d:"M22 22l-5 -5",key:"svg-2"}],["path",{d:"M17 22l5 -5",key:"svg-3"}]],P=q("outline","user-x","UserX",pe);function je({token:w,user:T}){const[x,p]=t.useState(!0),[j,f]=t.useState(!1),[l,u]=t.useState(null),[N,I]=t.useState([]),[n,M]=t.useState(""),[z,G]=t.useState([]),[g,R]=t.useState(""),[a,d]=t.useState([]),[i,S]=t.useState({});t.useEffect(()=>{C()},[]),t.useEffect(()=>{n&&_()},[n]),t.useEffect(()=>{g&&L()},[g]);const C=async()=>{p(!0);try{await new Promise(s=>setTimeout(s,500)),I([{id:1,name:"Grupo A - Mañana",course_name:"Desarrollo Web Full Stack"},{id:2,name:"Grupo B - Tarde",course_name:"Python Avanzado"},{id:3,name:"Grupo C - Noche",course_name:"React & TypeScript"}])}catch(s){console.error("Error cargando grupos:",s)}finally{p(!1)}},_=async s=>{try{await new Promise(r=>setTimeout(r,300)),G([{id:1,class_name:"Introducción a React",class_date:"2025-10-20",start_time:"10:00",end_time:"12:00"},{id:2,class_name:"Componentes y Props",class_date:"2025-10-22",start_time:"10:00",end_time:"12:00"},{id:3,class_name:"State y Hooks",class_date:"2025-10-24",start_time:"10:00",end_time:"12:00"}])}catch(r){console.error("Error cargando clases:",r)}},L=async s=>{try{await new Promise(h=>setTimeout(h,300));const r=[{id:1,name:"Ana García Mendoza",email:"ana.garcia@estudiante.edu.pe",photo:"/images/9440461.webp"},{id:2,name:"Luis Pérez Santos",email:"luis.perez@estudiante.edu.pe",photo:"/images/9440461.webp"},{id:3,name:"María Torres Vega",email:"maria.torres@estudiante.edu.pe",photo:"/images/9440461.webp"},{id:4,name:"José Ramírez Cruz",email:"jose.ramirez@estudiante.edu.pe",photo:"/images/9440461.webp"},{id:5,name:"Carmen López Silva",email:"carmen.lopez@estudiante.edu.pe",photo:"/images/9440461.webp"}];d(r);const b={};r.forEach(h=>{b[h.id]="absent"}),S(b)}catch(r){console.error("Error cargando estudiantes:",r)}},o=(s,r)=>{S(b=>({...b,[s]:r}))},X=()=>{const s={};a.forEach(r=>{s[r.id]="present"}),S(s)},K=async()=>{if(!g){u({type:"error",text:"Por favor, selecciona una clase primero"});return}f(!0);try{await new Promise(s=>setTimeout(s,1e3)),u({type:"success",text:"¡Asistencia registrada exitosamente!"}),setTimeout(()=>u(null),3e3)}catch(s){console.error("Error guardando asistencia:",s),u({type:"error",text:"Error al guardar la asistencia. Por favor, intenta nuevamente."})}finally{f(!1)}},D=(()=>{const s=Object.values(i).filter(h=>h==="present").length,r=Object.values(i).filter(h=>h==="absent").length,b=Object.values(i).filter(h=>h==="late").length;return{present:s,absent:r,late:b}})();return x?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(W,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Cargando grupos..."})]})}):e.jsxs("div",{className:"space-y-6",children:[l&&e.jsxs(ne,{variant:l.type==="error"?"destructive":"default",children:[l.type==="success"?e.jsx(le,{className:"h-4 w-4"}):e.jsx(ie,{className:"h-4 w-4"}),e.jsx(re,{children:l.type==="success"?"¡Éxito!":"Error"}),e.jsx(ce,{children:l.text})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Registro de Asistencia"}),e.jsx("p",{className:"text-muted-foreground",children:"Marca la asistencia de los estudiantes para cada clase"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(c,{children:[e.jsx(v,{children:e.jsx(y,{className:"text-base",children:"Seleccionar Grupo"})}),e.jsx(m,{children:e.jsxs(U,{value:n,onValueChange:M,children:[e.jsx(H,{children:e.jsx(V,{placeholder:"Elige un grupo"})}),e.jsx(O,{children:N.map(s=>e.jsxs($,{value:String(s.id),children:[s.name," - ",s.course_name]},s.id))})]})})]}),e.jsxs(c,{children:[e.jsx(v,{children:e.jsx(y,{className:"text-base",children:"Seleccionar Clase"})}),e.jsx(m,{children:e.jsxs(U,{value:g,onValueChange:R,disabled:!n,children:[e.jsx(H,{children:e.jsx(V,{placeholder:"Elige una clase"})}),e.jsx(O,{children:z.map(s=>e.jsxs($,{value:String(s.id),children:[s.class_name," - ",new Date(s.class_date).toLocaleDateString("es-PE")]},s.id))})]})})]})]}),g&&a.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(c,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold",children:a.length})]}),e.jsx(J,{className:"h-8 w-8 text-muted-foreground"})]})})}),e.jsx(c,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Presentes"}),e.jsx("p",{className:"text-2xl font-bold text-green-500",children:D.present})]}),e.jsx(k,{className:"h-8 w-8 text-green-500"})]})})}),e.jsx(c,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ausentes"}),e.jsx("p",{className:"text-2xl font-bold text-red-500",children:D.absent})]}),e.jsx(P,{className:"h-8 w-8 text-red-500"})]})})}),e.jsx(c,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Tardanzas"}),e.jsx("p",{className:"text-2xl font-bold text-amber-500",children:D.late})]}),e.jsx(E,{className:"h-8 w-8 text-amber-500"})]})})})]}),e.jsxs(c,{children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(y,{children:"Lista de Estudiantes"}),e.jsx(F,{children:"Marca la asistencia de cada estudiante"})]}),e.jsxs(A,{variant:"outline",onClick:X,size:"sm",children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Marcar Todos Presentes"]})]})}),e.jsxs(m,{children:[e.jsx("div",{className:"space-y-3",children:a.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsxs(Q,{className:"h-10 w-10",children:[e.jsx(Y,{src:s.photo}),e.jsx(Z,{children:s.name.split(" ").map(r=>r[0]).join("")})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.email})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(A,{size:"sm",variant:i[s.id]==="present"?"default":"outline",onClick:()=>o(s.id,"present"),className:i[s.id]==="present"?"bg-green-500 hover:bg-green-600":"",children:[e.jsx(k,{className:"h-4 w-4 mr-1"}),"Presente"]}),e.jsxs(A,{size:"sm",variant:i[s.id]==="late"?"default":"outline",onClick:()=>o(s.id,"late"),className:i[s.id]==="late"?"bg-amber-500 hover:bg-amber-600":"",children:[e.jsx(E,{className:"h-4 w-4 mr-1"}),"Tardanza"]}),e.jsxs(A,{size:"sm",variant:i[s.id]==="absent"?"default":"outline",onClick:()=>o(s.id,"absent"),className:i[s.id]==="absent"?"bg-red-500 hover:bg-red-600":"",children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),"Ausente"]})]})]},s.id))}),e.jsx("div",{className:"mt-6 pt-6 border-t",children:e.jsx(A,{onClick:K,disabled:j,className:"w-full",size:"lg",children:j?"Guardando...":"Guardar Asistencia"})})]})]})]}),!n&&e.jsx(c,{className:"p-12",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(J,{className:"h-16 w-16 text-muted-foreground mx-auto"}),e.jsx("h3",{className:"text-2xl font-semibold",children:"Selecciona un Grupo"}),e.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"Elige un grupo y una clase para comenzar a registrar la asistencia"})]})})]})}function ge({token:w,user:T}){const[x,p]=t.useState(!0),[j,f]=t.useState([]),[l,u]=t.useState(""),[N,I]=t.useState([]),[n,M]=t.useState(null);t.useEffect(()=>{z()},[]),t.useEffect(()=>{l&&G()},[l]);const z=async()=>{p(!0);try{await new Promise(d=>setTimeout(d,500));const a=[{id:1,name:"Grupo A - Mañana",course_name:"Desarrollo Web Full Stack"},{id:2,name:"Grupo B - Tarde",course_name:"Python Avanzado"}];f(a),a.length>0&&u(String(a[0].id))}catch(a){console.error("Error cargando grupos:",a)}finally{p(!1)}},G=async a=>{try{await new Promise(o=>setTimeout(o,500));const d=[{id:1,class_name:"Introducción a React",class_date:"2025-10-15",status:"present",marked_at:"2025-10-15 10:05:00"},{id:2,class_name:"Componentes y Props",class_date:"2025-10-17",status:"present",marked_at:"2025-10-17 10:02:00"},{id:3,class_name:"State y Hooks",class_date:"2025-10-19",status:"late",marked_at:"2025-10-19 10:15:00"},{id:4,class_name:"Manejo de Eventos",class_date:"2025-10-20",status:"present",marked_at:"2025-10-20 10:03:00"},{id:5,class_name:"Formularios en React",class_date:"2025-10-22",status:"absent",marked_at:"2025-10-22 12:00:00"}];I(d);const i=d.filter(o=>o.status==="present").length,S=d.filter(o=>o.status==="absent").length,C=d.filter(o=>o.status==="late").length,_=d.length,L=_>0?(i+C*.5)/_*100:0;M({total_classes:_,present_count:i,absent_count:S,late_count:C,attendance_percentage:Math.round(L*10)/10})}catch(d){console.error("Error cargando asistencias:",d)}},g=a=>{switch(a){case"present":return e.jsxs(B,{className:"bg-green-500/10 text-green-500 border-green-500/20",children:[e.jsx(k,{className:"h-3 w-3 mr-1"}),"Presente"]});case"late":return e.jsxs(B,{className:"bg-amber-500/10 text-amber-500 border-amber-500/20",children:[e.jsx(E,{className:"h-3 w-3 mr-1"}),"Tardanza"]});case"absent":return e.jsxs(B,{className:"bg-red-500/10 text-red-500 border-red-500/20",children:[e.jsx(P,{className:"h-3 w-3 mr-1"}),"Ausente"]});default:return null}},R=a=>a>=90?"text-green-500":a>=75?"text-blue-500":a>=60?"text-amber-500":"text-red-500";return x?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(W,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Cargando asistencias..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Mi Asistencia"}),e.jsx("p",{className:"text-muted-foreground",children:"Consulta tu registro de asistencias a las clases"})]}),e.jsxs(c,{children:[e.jsx(v,{children:e.jsx(y,{className:"text-base",children:"Seleccionar Grupo"})}),e.jsx(m,{children:e.jsxs(U,{value:l,onValueChange:u,children:[e.jsx(H,{children:e.jsx(V,{placeholder:"Elige un grupo"})}),e.jsx(O,{children:j.map(a=>e.jsxs($,{value:String(a.id),children:[a.name," - ",a.course_name]},a.id))})]})})]}),n&&e.jsxs(e.Fragment,{children:[e.jsxs(c,{children:[e.jsxs(v,{children:[e.jsx(y,{children:"Resumen de Asistencia"}),e.jsx(F,{children:"Tu desempeño en el grupo seleccionado"})]}),e.jsxs(m,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Porcentaje de Asistencia"}),e.jsxs("span",{className:`text-2xl font-bold ${R(n.attendance_percentage)}`,children:[n.attendance_percentage,"%"]})]}),e.jsx(de,{value:n.attendance_percentage,className:"h-3"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:n.attendance_percentage>=75?"¡Excelente! Mantienes una buena asistencia":n.attendance_percentage>=60?"Atención: Necesitas mejorar tu asistencia":"Advertencia: Tu asistencia está por debajo del mínimo"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Clases"}),e.jsx("p",{className:"text-2xl font-bold",children:n.total_classes})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(k,{className:"h-3 w-3 text-green-500"}),"Presentes"]}),e.jsx("p",{className:"text-2xl font-bold text-green-500",children:n.present_count})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(E,{className:"h-3 w-3 text-amber-500"}),"Tardanzas"]}),e.jsx("p",{className:"text-2xl font-bold text-amber-500",children:n.late_count})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(P,{className:"h-3 w-3 text-red-500"}),"Ausentes"]}),e.jsx("p",{className:"text-2xl font-bold text-red-500",children:n.absent_count})]})]})]})]}),e.jsxs(c,{children:[e.jsxs(v,{children:[e.jsx(y,{children:"Historial de Asistencias"}),e.jsx(F,{children:"Registro detallado de tus asistencias por clase"})]}),e.jsx(m,{children:e.jsx("div",{className:"space-y-3",children:N.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:a.class_name})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsx("span",{children:new Date(a.class_date).toLocaleDateString("es-PE",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Registrado: ",new Date(a.marked_at).toLocaleTimeString("es-PE",{hour:"2-digit",minute:"2-digit"})]})]})]}),e.jsx("div",{children:g(a.status)})]},a.id))})})]}),e.jsx(c,{className:"bg-blue-500/5 border-blue-500/20",children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"p-3 bg-blue-500/10 rounded-lg",children:e.jsx(me,{className:"h-6 w-6 text-blue-500"})})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"font-semibold",children:"Requisito de Asistencia"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Recuerda que necesitas mantener al menos un 75% de asistencia para aprobar el curso. Las tardanzas cuentan como media asistencia."})]})]})})})]}),!l&&j.length===0&&e.jsx(c,{className:"p-12",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(k,{className:"h-16 w-16 text-muted-foreground mx-auto"}),e.jsx("h3",{className:"text-2xl font-semibold",children:"No hay grupos disponibles"}),e.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"Aún no estás inscrito en ningún grupo. Explora el catálogo de cursos para comenzar."})]})})]})}function Ge(){const[w,T]=t.useState(null),[x,p]=t.useState(null),[j,f]=t.useState(!1);if(t.useEffect(()=>{const u=window.localStorage.getItem("token"),N=window.localStorage.getItem("user");T(u??null);try{p(N?JSON.parse(N):null)}catch{p(null)}f(!0)},[]),!j)return null;const l=x?.role==="teacher"||x?.role==="docente";return e.jsxs(ee,{style:{"--sidebar-width":"calc(var(--spacing) * 72)","--header-height":"calc(var(--spacing) * 12)"},children:[e.jsx(se,{variant:"inset",token:w,user:x}),e.jsxs(ae,{children:[e.jsx(te,{title:"Seguimiento de Asistencia"}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx("div",{className:"@container/main flex flex-1 flex-col",children:e.jsx("div",{className:"flex-1 py-4 md:py-6",children:e.jsx("section",{className:"px-4 md:px-6 lg:px-10",children:l?e.jsx(je,{token:w,user:x}):e.jsx(ge,{token:w,user:x})})})})})]})]})}export{Ge as default};
