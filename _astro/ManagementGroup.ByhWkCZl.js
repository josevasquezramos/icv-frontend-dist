import{j as e,B as D,c as A}from"./config.DA722Lej.js";import{r as c,R as Ce}from"./index.BVn2TZg3.js";import{c as I,I as ge,d as le,e as ne,f as ie,S as Ee,A as ke,a as Se,b as De}from"./site-header.CcIO_pl4.js";import{T as Me,a as Te,b as O,c as U}from"./tabs.D3fGBOZl.js";import{C as P,a as $,b as Q,c as q,d as fe,e as ve}from"./card.BSoSeF1_.js";import{B as _}from"./badge.FyzJaTHz.js";import{D as de,a as me,b as xe,c as ue,d as he,e as pe}from"./dialog.FtcbSCI6.js";import{I as F}from"./input.BGbgNwpT.js";import{L as T}from"./label.C2QC9qaa.js";import{T as Ne,I as be}from"./textarea.CjtBwcT2.js";import{S as J,a as Y,b as K,c as X,d as ee}from"./select.KVc0F5mA.js";import{C as Pe}from"./CloudinaryUploader.C4WVz9yp.js";import{I as ae}from"./IconCheck.CXf9P-ea.js";import{I as L}from"./IconCalendar.DYjqBcxp.js";import{I as z}from"./IconLoader.CpSXqs7V.js";import{I as V}from"./IconPlus.D6j8F5Jb.js";import{I as W,a as Z,b as je,c as ce}from"./IconUser.DkuoL3Ke.js";import{I as $e}from"./IconClock.DGc1Ztyo.js";import{I as se}from"./IconUsers.C-x-aE1c.js";import{I as H}from"./IconVideo.BIWMJyzU.js";import"./createLucideIcon.Cw3puCNq.js";import"./video.BZwMdyWj.js";/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"M10 5a2 2 0 0 1 4 0a7 7 0 0 1 4 6v3a4 4 0 0 0 2 3h-16a4 4 0 0 0 2 -3v-3a7 7 0 0 1 4 -6",key:"svg-0"}],["path",{d:"M9 17v1a3 3 0 0 0 6 0v-1",key:"svg-1"}],["path",{d:"M21 6.727a11.05 11.05 0 0 0 -2.794 -3.727",key:"svg-2"}],["path",{d:"M3 6.727a11.05 11.05 0 0 1 2.792 -3.727",key:"svg-3"}]],Fe=I("outline","bell-ringing","BellRinging",Ae);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"M12 6l4 6l5 -4l-2 10h-14l-2 -10l5 4z",key:"svg-0"}]],re=I("outline","crown","Crown",Ie);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1",key:"svg-0"}],["path",{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z",key:"svg-1"}],["path",{d:"M16 5l3 3",key:"svg-2"}]],ye=I("outline","edit","Edit",Le);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=[["path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6",key:"svg-0"}],["path",{d:"M11 13l9 -9",key:"svg-1"}],["path",{d:"M15 4h5v5",key:"svg-2"}]],te=I("outline","external-link","ExternalLink",Ge);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6",key:"svg-1"}]],oe=I("outline","eye","Eye",ze);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M9 9l1 0",key:"svg-2"}],["path",{d:"M9 13l6 0",key:"svg-3"}],["path",{d:"M9 17l6 0",key:"svg-4"}]],Ve=I("outline","file-text","FileText",Be);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M12 9m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0",key:"svg-0"}],["path",{d:"M12 14v7",key:"svg-1"}],["path",{d:"M9 18h6",key:"svg-2"}]],Oe=I("outline","gender-female","GenderFemale",Re);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"M10 14m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0",key:"svg-0"}],["path",{d:"M19 5l-5.4 5.4",key:"svg-1"}],["path",{d:"M19 5h-5",key:"svg-2"}],["path",{d:"M19 5v5",key:"svg-3"}]],He=I("outline","gender-male","GenderMale",Ue);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]],we=I("outline","link","Link",We);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["path",{d:"M22 9l-10 -4l-10 4l10 4l10 -4v6",key:"svg-0"}],["path",{d:"M6 10.6v5.4a6 3 0 0 0 12 0v-5.4",key:"svg-1"}]],_e=I("outline","school","School",Qe);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["path",{d:"M8 21l8 0",key:"svg-0"}],["path",{d:"M12 17l0 4",key:"svg-1"}],["path",{d:"M7 4l10 0",key:"svg-2"}],["path",{d:"M17 4v8a5 5 0 0 1 -10 0v-8",key:"svg-3"}],["path",{d:"M5 9m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-4"}],["path",{d:"M19 9m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-5"}]],Ze=I("outline","trophy","Trophy",qe);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["path",{d:"M12 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-0"}],["path",{d:"M6.835 9h10.33a1 1 0 0 1 .984 .821l1.637 9a1 1 0 0 1 -.984 1.179h-13.604a1 1 0 0 1 -.984 -1.179l1.637 -9a1 1 0 0 1 .984 -.821z",key:"svg-1"}]],Ye=I("outline","weight","Weight",Je);function Ke({isOpen:b,onClose:f,onAnnouncementCreated:C,groupId:h,token:E,teacherId:k}){const[l,w]=c.useState({title:"",content:"",image_url:"",display_type:"info",target_page:"course",link_url:"",button_text:"",status:"draft",start_date:"",end_date:"",created_by:k}),[d,j]=c.useState(!1),[S,v]=c.useState(null),[m,N]=c.useState(!1),r=[{value:"banner",label:"Banner",description:"Anuncio destacado con imagen"},{value:"alert",label:"Alerta",description:"Para recordatorios importantes"},{value:"info",label:"Informativo",description:"Anuncio general de informaci√≥n"},{value:"schedule",label:"Horario",description:"Informaci√≥n de fechas y horarios"}],o=[{value:"course",label:"P√°gina del Curso"},{value:"evaluations",label:"Evaluaciones"},{value:"materials",label:"Materiales"},{value:"calendar",label:"Calendario"},{value:"announcements",label:"Anuncios"}],p=[{value:"draft",label:"Borrador"},{value:"published",label:"Publicado"},{value:"scheduled",label:"Programado"}],g=(a,n)=>{w(u=>({...u,[a]:n})),S&&v(null)},M=async a=>{a.preventDefault(),j(!0),v(null);try{const n=E?.replace(/^"|"$/g,""),u={...l,id_announcement:Math.floor(1e3+Math.random()*9e3),created_by:k};console.log("Datos del anuncio a crear:",u),await new Promise(y=>setTimeout(y,1e3)),N(!0),setTimeout(()=>{t(),C(),f()},1500)}catch(n){console.error("Error creando anuncio:",n),v(n instanceof Error?n.message:"Error al crear el anuncio")}finally{j(!1)}},t=()=>{w({title:"",content:"",image_url:"",display_type:"info",target_page:"course",link_url:"",button_text:"",status:"draft",start_date:"",end_date:"",created_by:k}),v(null),N(!1)},i=()=>{t(),f()},x=()=>new Date().toISOString().split("T")[0],s=a=>{const u={banner:{label:"Banner",variant:"default",color:"bg-blue-100 text-blue-800"},alert:{label:"Alerta",variant:"secondary",color:"bg-orange-100 text-orange-800"},info:{label:"Informativo",variant:"outline",color:"bg-green-100 text-green-800"},schedule:{label:"Horario",variant:"outline",color:"bg-purple-100 text-purple-800"}}[a]||{label:a,variant:"outline",color:"bg-gray-100 text-gray-800"};return e.jsx(_,{variant:u.variant,className:u.color,children:u.label})};return e.jsx(de,{open:b,onOpenChange:i,children:e.jsxs(me,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(xe,{children:[e.jsx(ue,{className:"text-2xl font-bold",children:"Crear Nuevo Anuncio"}),e.jsx(he,{children:"Completa la informaci√≥n para crear un nuevo anuncio para el grupo."})]}),e.jsxs("form",{onSubmit:M,className:"space-y-6 py-4",children:[S&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700 text-sm",children:S})}),m&&e.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4 text-green-600"}),e.jsx("p",{className:"text-green-700 text-sm",children:"¬°Anuncio creado exitosamente!"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"title",className:"text-sm font-medium",children:"T√≠tulo del anuncio *"}),e.jsx(F,{id:"title",placeholder:"Ej: Recordatorio de Examen Parcial",value:l.title,onChange:a=>g("title",a.target.value),required:!0,disabled:d})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"display_type",className:"text-sm font-medium",children:"Tipo de visualizaci√≥n *"}),e.jsxs(J,{value:l.display_type,onValueChange:a=>g("display_type",a),disabled:d,children:[e.jsx(Y,{children:e.jsx(K,{placeholder:"Selecciona un tipo"})}),e.jsx(X,{children:r.map(a=>e.jsx(ee,{value:a.value,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:a.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:a.description})]})},a.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"status",className:"text-sm font-medium",children:"Estado *"}),e.jsxs(J,{value:l.status,onValueChange:a=>g("status",a),disabled:d,children:[e.jsx(Y,{children:e.jsx(K,{placeholder:"Selecciona un estado"})}),e.jsx(X,{children:p.map(a=>e.jsx(ee,{value:a.value,children:a.label},a.value))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"target_page",className:"text-sm font-medium",children:"P√°gina destino"}),e.jsxs(J,{value:l.target_page,onValueChange:a=>g("target_page",a),disabled:d,children:[e.jsx(Y,{children:e.jsx(K,{placeholder:"Selecciona una p√°gina"})}),e.jsx(X,{children:o.map(a=>e.jsx(ee,{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"start_date",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"Fecha de inicio"]}),e.jsx(F,{id:"start_date",type:"datetime-local",value:l.start_date,onChange:a=>g("start_date",a.target.value),min:x(),disabled:d})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"end_date",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"Fecha de fin"]}),e.jsx(F,{id:"end_date",type:"datetime-local",value:l.end_date,onChange:a=>g("end_date",a.target.value),min:l.start_date||x(),disabled:d})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(T,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),"Imagen del anuncio (opcional)"]}),l.image_url?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative aspect-video max-w-md overflow-hidden rounded-lg border",children:[e.jsx("img",{src:l.image_url,alt:"Vista previa",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsxs(_,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(oe,{className:"h-3 w-3"}),"Vista previa"]})})]}),e.jsx(D,{type:"button",variant:"outline",size:"sm",onClick:()=>g("image_url",""),disabled:d,children:"Cambiar imagen"})]}):e.jsx(Pe,{onUpload:a=>w(n=>({...n,image_url:a})),acceptType:"image"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Recomendado para anuncios tipo Banner. Tama√±o sugerido: 1200x600px"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"link_url",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"Enlace de acci√≥n"]}),e.jsx(F,{id:"link_url",type:"url",placeholder:"https://ejemplo.com/destino",value:l.link_url,onChange:a=>g("link_url",a.target.value),disabled:d})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"button_text",className:"text-sm font-medium",children:"Texto del bot√≥n"}),e.jsx(F,{id:"button_text",placeholder:"Ej: Ver m√°s informaci√≥n",value:l.button_text,onChange:a=>g("button_text",a.target.value),disabled:d})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"content",className:"text-sm font-medium",children:"Contenido del anuncio *"}),e.jsx(Ne,{id:"content",placeholder:"Escribe el contenido completo del anuncio aqu√≠...",value:l.content,onChange:a=>g("content",a.target.value),rows:6,required:!0,disabled:d}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Puedes usar saltos de l√≠nea para formatear el texto. Los anuncios soportan formato b√°sico."})]}),e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsxs("h4",{className:"font-medium text-sm mb-2 flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"Vista previa del tipo"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Este anuncio se mostrar√° como:"}),s(l.display_type)]})]}),e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-sm mb-2 text-blue-800",children:"Informaci√≥n del grupo"}),e.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[e.jsxs("p",{children:["ID del grupo: ",h]}),e.jsxs("p",{children:["Docente creador: ID ",k]}),e.jsxs("p",{children:["Tipo seleccionado: ",r.find(a=>a.value===l.display_type)?.label]})]})]}),e.jsxs(pe,{className:"gap-3 sm:gap-0",children:[e.jsx(D,{type:"button",variant:"outline",onClick:i,disabled:d,children:"Cancelar"}),e.jsx(D,{type:"submit",disabled:d||!l.title||!l.content,children:d?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"h-4 w-4 mr-2 animate-spin"}),"Creando..."]}):"Crear Anuncio"})]})]})]})})}function Xe({groupId:b,token:f,isTeacher:C,teacherId:h}){const[E,k]=c.useState([]),[l,w]=c.useState(!0),[d,j]=c.useState(null),[S,v]=c.useState(!1);c.useEffect(()=>{m()},[b]);const m=async()=>{try{await new Promise(i=>setTimeout(i,500)),k([{id:1,id_announcement:1001,title:"Bienvenida al Curso de Desarrollo Web",content:`¬°Bienvenidos a todos al curso de Desarrollo Web Full Stack! üéâ

Estamos emocionados de comenzar este viaje de aprendizaje juntos. En este curso exploraremos las tecnolog√≠as fundamentales para el desarrollo web moderno:

‚Ä¢ HTML5 y sem√°ntica web
‚Ä¢ CSS3 y dise√±o responsive
‚Ä¢ JavaScript ES6+
‚Ä¢ React y componentes
‚Ä¢ Node.js y backend

Recuerden revisar el material de la primera clase y preparar su entorno de desarrollo. Nos vemos en la primera sesi√≥n virtual.`,image_url:"https://res.cloudinary.com/dshi5w2wt/image/upload/v1761195457/xjjtjo1hym5bqcfrxwlj.png",display_type:"banner",target_page:"course",link_url:"/academico/groups/1",button_text:"Ir al Curso",status:"published",start_date:"2025-01-10T00:00:00Z",end_date:"2025-01-20T23:59:59Z",views:45,created_by:2,created_date:"2025-01-10T09:00:00Z",author:{id:2,full_name:"Carlos Garc√≠a"}},{id:2,id_announcement:1002,title:"Recordatorio: Examen Parcial Programado",content:`Estimados estudiantes,

Les informamos que el examen parcial del m√≥dulo de HTML/CSS est√° programado para el pr√≥ximo viernes 15 de febrero.

Detalles importantes:
- Fecha: Viernes 15 de febrero
- Hora: 09:00 - 11:00 AM
- Duraci√≥n: 2 horas
- Modalidad: Virtual a trav√©s de la plataforma
- Temas: Todos los vistos hasta la clase 8

Prep√°rense revisando los ejercicios pr√°cticos y los conceptos te√≥ricos vistos en clase. ¬°Mucho √©xito!`,image_url:null,display_type:"alert",target_page:"evaluations",link_url:"/academico/groups/1/evaluations",button_text:"Ver Evaluaciones",status:"published",start_date:"2025-02-10T00:00:00Z",end_date:"2025-02-15T11:00:00Z",views:32,created_by:2,created_date:"2025-02-10T14:30:00Z",author:{id:2,full_name:"Carlos Garc√≠a"}},{id:3,id_announcement:1003,title:"Nuevo Material de Estudio Disponible",content:`Hemos agregado nuevo material de estudio para el m√≥dulo de JavaScript:

‚Ä¢ Gu√≠a de arrays y m√©todos
‚Ä¢ Ejercicios pr√°cticos de funciones
‚Ä¢ Proyecto ejemplo de DOM manipulation
‚Ä¢ Recursos adicionales de ES6+

Pueden acceder al material desde la secci√≥n de recursos del curso. Recuerden que la pr√°ctica constante es clave para el aprendizaje.`,image_url:"https://res.cloudinary.com/dshi5w2wt/image/upload/v1761192083/el-desarrollo-web_oapcly.webp",display_type:"info",target_page:"materials",link_url:"/academico/groups/1/materials",button_text:"Ver Materiales",status:"published",start_date:"2025-01-25T00:00:00Z",end_date:null,views:28,created_by:2,created_date:"2025-01-25T10:15:00Z",author:{id:2,full_name:"Carlos Garc√≠a"}},{id:4,id_announcement:1004,title:"Horario de Asesor√≠as Personalizadas",content:`A partir de la pr√≥xima semana, estar√© disponible para asesor√≠as personalizadas:

Horarios disponibles:
- Lunes y Mi√©rcoles: 2:00 PM - 4:00 PM
- Viernes: 9:00 AM - 11:00 AM

Pueden agendar su sesi√≥n a trav√©s del calendario del curso. Las asesor√≠as son opcionales pero recomendadas para resolver dudas espec√≠ficas.`,image_url:null,display_type:"schedule",target_page:"calendar",link_url:"/academico/calendar",button_text:"Ver Calendario",status:"published",start_date:"2025-01-20T00:00:00Z",end_date:"2025-03-15T23:59:59Z",views:19,created_by:2,created_date:"2025-01-18T16:45:00Z",author:{id:2,full_name:"Carlos Garc√≠a"}}])}catch(t){console.error("Error cargando anuncios:",t),j("Error al cargar los anuncios")}finally{w(!1)}},N=()=>{v(!0)},r=()=>{m()},o=t=>{const x={published:{label:"Publicado",variant:"default"},draft:{label:"Borrador",variant:"outline"},scheduled:{label:"Programado",variant:"secondary"},archived:{label:"Archivado",variant:"outline"}}[t]||{label:t,variant:"outline"};return e.jsx(_,{variant:x.variant,children:x.label})},p=t=>{const x={banner:{label:"Banner",variant:"default",color:"bg-blue-100 text-blue-800"},alert:{label:"Alerta",variant:"secondary",color:"bg-orange-100 text-orange-800"},info:{label:"Informativo",variant:"outline",color:"bg-green-100 text-green-800"},schedule:{label:"Horario",variant:"outline",color:"bg-purple-100 text-purple-800"}}[t||"info"]||{label:t||"General",variant:"outline",color:"bg-gray-100 text-gray-800"};return e.jsx(_,{variant:x.variant,className:x.color,children:x.label})},g=t=>new Date(t).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),M=t=>{const i=new Date,x=t.start_date?new Date(t.start_date):null,s=t.end_date?new Date(t.end_date):null;return x&&i<x||s&&i>s?!1:t.status==="published"};return l?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(z,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"text-muted-foreground",children:"Cargando anuncios..."})]}):d?e.jsxs("div",{className:"text-center py-12 space-y-4",children:[e.jsx("p",{className:"text-red-500 text-lg font-medium",children:d}),e.jsx(D,{onClick:m,children:"Reintentar"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Anuncios del Grupo"}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:[E.length," ",E.length===1?"anuncio":"anuncios"," en total"]})]}),C&&e.jsxs(D,{onClick:N,children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Nuevo Anuncio"]})]}),e.jsx(Ke,{isOpen:S,onClose:()=>v(!1),onAnnouncementCreated:r,groupId:b,token:f,teacherId:h}),E.length===0?e.jsx(P,{className:"text-center py-16",children:e.jsx($,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(L,{className:"h-16 w-16 text-muted-foreground mx-auto"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-muted-foreground",children:"No hay anuncios"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:C?"Comienza creando el primer anuncio del grupo":"A√∫n no hay anuncios publicados para este grupo"})]}),C&&e.jsxs(D,{onClick:N,className:"mt-4",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Crear Primer Anuncio"]})]})})}):e.jsx("div",{className:"space-y-6",children:E.map(t=>e.jsxs(P,{className:`hover:shadow-lg transition-all ${M(t)?"":"opacity-60"}`,children:[e.jsx(Q,{children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-start justify-between gap-4",children:e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx(q,{className:"text-xl",children:t.title}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[o(t.status),p(t.display_type)]})]}),e.jsxs(fe,{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs("span",{className:"flex items-center gap-1",children:["Por ",t.author?.full_name||"Sistema"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"h-4 w-4"}),g(t.created_date)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(oe,{className:"h-4 w-4"}),t.views," vistas"]})]}),(t.start_date||t.end_date)&&e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-muted-foreground",children:[t.start_date&&e.jsxs("span",{children:["Inicio: ",g(t.start_date)]}),t.end_date&&e.jsxs("span",{children:["Fin: ",g(t.end_date)]})]})]})})}),e.jsxs($,{className:"space-y-4",children:[t.image_url&&e.jsxs("div",{className:"relative aspect-video overflow-hidden rounded-lg bg-muted",children:[e.jsx("img",{src:t.image_url,alt:t.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-2 left-2",children:e.jsxs(_,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(te,{className:"h-3 w-3"}),"Imagen"]})})]}),e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap text-muted-foreground",children:t.content})})]}),t.link_url&&t.button_text&&e.jsx(ve,{children:e.jsx(D,{asChild:!0,variant:"outline",size:"sm",className:"flex items-center gap-2",children:e.jsxs("a",{href:t.link_url,target:t.link_url.startsWith("http")?"_blank":"_self",rel:"noopener noreferrer",children:[e.jsx(te,{className:"h-4 w-4"}),t.button_text]})})})]},t.id))})]})}function ea({isOpen:b,onClose:f,onEvaluationCreated:C,groupId:h,token:E,teacherId:k}){const[l,w]=c.useState({group_id:h,title:"",description:"",external_url:"",evaluation_type:"",due_date:"",weight:"",teacher_creator_id:k}),[d,j]=c.useState(!1),[S,v]=c.useState(null),[m,N]=c.useState(!1),r=[{value:"Exam",label:"Examen"},{value:"Project",label:"Proyecto"},{value:"Quiz",label:"Quiz"},{value:"Assignment",label:"Tarea"}],o=(i,x)=>{w(s=>({...s,[i]:x})),S&&v(null)},p=async i=>{i.preventDefault(),j(!0),v(null);try{const x=E?.replace(/^"|"$/g,""),s=await fetch(`${A.apiUrl}${A.endpoints.evaluations.create}`,{method:"POST",headers:{Authorization:`Bearer ${x}`,"Content-Type":"application/json"},body:JSON.stringify({...l,weight:parseFloat(l.weight),teacher_creator_id:k})});if(!s.ok){const n=await s.json();throw new Error(n.message||"Error al crear la evaluaci√≥n")}const a=await s.json();console.log("Evaluaci√≥n creada:",a),N(!0),setTimeout(()=>{g(),C(),f()},1500)}catch(x){console.error("Error creando evaluaci√≥n:",x),v(x instanceof Error?x.message:"Error al crear la evaluaci√≥n")}finally{j(!1)}},g=()=>{w({group_id:h,title:"",description:"",external_url:"",evaluation_type:"",due_date:"",weight:"",teacher_creator_id:k}),v(null),N(!1)},M=()=>{g(),f()},t=()=>new Date().toISOString().split("T")[0];return e.jsx(de,{open:b,onOpenChange:M,children:e.jsxs(me,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(xe,{children:[e.jsx(ue,{className:"text-2xl font-bold",children:"Crear Nueva Evaluaci√≥n"}),e.jsx(he,{children:"Completa la informaci√≥n para crear una nueva evaluaci√≥n para el grupo."})]}),e.jsxs("form",{onSubmit:p,className:"space-y-6 py-4",children:[S&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700 text-sm",children:S})}),m&&e.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4 text-green-600"}),e.jsx("p",{className:"text-green-700 text-sm",children:"¬°Evaluaci√≥n creada exitosamente!"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"title",className:"text-sm font-medium",children:"T√≠tulo de la evaluaci√≥n *"}),e.jsx(F,{id:"title",placeholder:"Ej: Examen Parcial - HTML/CSS",value:l.title,onChange:i=>o("title",i.target.value),required:!0,disabled:d})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"evaluation_type",className:"text-sm font-medium",children:"Tipo de evaluaci√≥n *"}),e.jsxs(J,{value:l.evaluation_type,onValueChange:i=>o("evaluation_type",i),disabled:d,children:[e.jsx(Y,{children:e.jsx(K,{placeholder:"Selecciona un tipo"})}),e.jsx(X,{children:r.map(i=>e.jsx(ee,{value:i.value,children:i.label},i.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"weight",className:"text-sm font-medium",children:"Peso (puntos) *"}),e.jsx(F,{id:"weight",type:"number",step:"0.1",min:"0",max:"100",placeholder:"Ej: 2.0",value:l.weight,onChange:i=>o("weight",i.target.value),required:!0,disabled:d})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"due_date",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"Fecha de vencimiento *"]}),e.jsx(F,{id:"due_date",type:"datetime-local",value:l.due_date,onChange:i=>o("due_date",i.target.value),min:t(),required:!0,disabled:d})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"external_url",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"Enlace externo (opcional)"]}),e.jsx(F,{id:"external_url",type:"url",placeholder:"https://ejemplo.com/evaluacion",value:l.external_url,onChange:i=>o("external_url",i.target.value),disabled:d}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"URL donde los estudiantes realizar√°n la evaluaci√≥n"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"description",className:"text-sm font-medium",children:"Descripci√≥n (opcional)"}),e.jsx(Ne,{id:"description",placeholder:"Describe los objetivos y requisitos de la evaluaci√≥n...",value:l.description,onChange:i=>o("description",i.target.value),rows:4,disabled:d})]}),e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Informaci√≥n del grupo"}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsxs("p",{children:["ID del grupo: ",h]}),e.jsxs("p",{children:["Docente creador: ID ",k]})]})]}),e.jsxs(pe,{className:"gap-3 sm:gap-0",children:[e.jsx(D,{type:"button",variant:"outline",onClick:M,disabled:d,children:"Cancelar"}),e.jsx(D,{type:"submit",disabled:d||!l.title||!l.evaluation_type||!l.due_date||!l.weight,children:d?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"h-4 w-4 mr-2 animate-spin"}),"Creando..."]}):"Crear Evaluaci√≥n"})]})]})]})})}function aa({groupId:b,token:f,isTeacher:C,teacherId:h}){const[E,k]=c.useState([]),[l,w]=c.useState(!0),[d,j]=c.useState(null),[S,v]=c.useState(!1);c.useEffect(()=>{m()},[b]);const m=async()=>{if(f){w(!0),j(null);try{const t=f.replace(/^"|"$/g,""),i=`${A.apiUrl}${A.endpoints.evaluations.getByGroup}`.replace(":groupId",b),x=await fetch(i,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!x.ok)throw new Error(`Error al cargar evaluaciones: ${x.status}`);const s=await x.json();k(s.evaluations||[])}catch(t){console.error("Error cargando evaluaciones:",t),j(t instanceof Error?t.message:"Error al cargar evaluaciones")}finally{w(!1)}}},N=()=>{v(!0)},r=()=>{m()},o=t=>{const x={Exam:{label:"Examen",variant:"default",color:"bg-red-100 text-red-800 border-red-200"},Project:{label:"Proyecto",variant:"secondary",color:"bg-blue-100 text-blue-800 border-blue-200"},Quiz:{label:"Quiz",variant:"outline",color:"bg-green-100 text-green-800 border-green-200"},Assignment:{label:"Tarea",variant:"outline",color:"bg-purple-100 text-purple-800 border-purple-200"}}[t]||{label:t,variant:"outline",color:"bg-gray-100 text-gray-800 border-gray-200"};return e.jsx(_,{variant:x.variant,className:x.color,children:x.label})},p=t=>{const i=parseFloat(t);let x="outline";return i>=2?x="default":i>=1&&(x="secondary"),e.jsxs(_,{variant:x,className:"flex items-center gap-1",children:[e.jsx(Ye,{className:"h-3 w-3"}),t," pts"]})},g=t=>new Date(t).toLocaleDateString("es-PE",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),M=t=>{const i=new Date,s=new Date(t).getTime()-i.getTime(),a=Math.ceil(s/(1e3*60*60*24));return a<0?e.jsx(_,{variant:"destructive",children:"Vencido"}):a===0?e.jsx(_,{variant:"secondary",children:"Vence hoy"}):a===1?e.jsx(_,{variant:"secondary",children:"Vence en 1 d√≠a"}):a<=7?e.jsxs(_,{variant:"secondary",children:["Vence en ",a," d√≠as"]}):e.jsxs(_,{variant:"outline",children:["Vence en ",a," d√≠as"]})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Evaluaciones"}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:[E.length," ",E.length===1?"evaluaci√≥n":"evaluaciones"," en total"]})]}),C&&e.jsxs(D,{onClick:N,children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Crear Evaluaci√≥n"]})]}),E.length===0?e.jsx(P,{className:"text-center py-16",children:e.jsx($,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(L,{className:"h-16 w-16 text-muted-foreground mx-auto"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-muted-foreground",children:"No hay evaluaciones"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:C?"Comienza creando la primera evaluaci√≥n del grupo":"A√∫n no hay evaluaciones programadas para este grupo"})]}),C&&e.jsxs(D,{onClick:N,className:"mt-4",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Crear Primera Evaluaci√≥n"]})]})})}):e.jsx("div",{className:"space-y-4",children:E.map(t=>e.jsxs(P,{className:"hover:shadow-md transition-shadow",children:[e.jsx(Q,{children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-start justify-between gap-4",children:e.jsxs("div",{className:"space-y-3 flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx(q,{className:"text-xl",children:t.title}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[o(t.evaluation_type),p(t.weight)]})]}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:t.description}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsxs("span",{children:["Creado por: ",t.teacher_creator.full_name]})]})]})})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(L,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium text-sm",children:"Fecha de vencimiento"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:g(t.due_date)}),e.jsx("div",{className:"mt-2",children:M(t.due_date)})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx($e,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Creado"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(t.created_at).toLocaleDateString("es-PE")})]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(te,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:"Enlace de evaluaci√≥n"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Accede a la plataforma externa para realizar la evaluaci√≥n"}),e.jsx(D,{asChild:!0,variant:"default",className:"w-full sm:w-auto",children:e.jsxs("a",{href:t.external_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),"Ir a la evaluaci√≥n"]})})]})]})})]})})]},t.id))})]}),e.jsx(ea,{isOpen:S,onClose:()=>v(!1),onEvaluationCreated:r,groupId:b,token:f,teacherId:h})]})}function sa({isOpen:b,onClose:f,onGradesUpdated:C,student:h,evaluations:E,token:k,isTeacher:l}){const[w,d]=c.useState({}),[j,S]=c.useState(!1),[v,m]=c.useState(null),[N,r]=c.useState(!1),[o,p]=c.useState(null);Ce.useEffect(()=>{const a={};h.evaluations.forEach(n=>{a[n.evaluation_id]={obtained_grade:n.obtained_grade||"",feedback:n.feedback||""}}),d(a)},[h]);const g=(a,n,u)=>{d(y=>({...y,[a]:{...y[a],[n]:u}})),v&&m(null)},M=async a=>{if(k){S(!0),m(null);try{const n=k.replace(/^"|"$/g,""),u=w[a];if(!u.obtained_grade)throw new Error("La calificaci√≥n es requerida");const y=parseFloat(u.obtained_grade);if(isNaN(y)||y<0||y>20)throw new Error("La calificaci√≥n debe ser un n√∫mero entre 0 y 20");const G=h.evaluations.find(R=>R.evaluation_id===a);let B;if(G?.obtained_grade?B=await fetch(`${A.apiUrl}${A.endpoints.grades.create}`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({evaluation_id:a,student_id:h.id,obtained_grade:y,feedback:u.feedback||null})}):B=await fetch(`${A.apiUrl}${A.endpoints.grades.create}`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({evaluation_id:a,student_id:h.id,obtained_grade:y,feedback:u.feedback||null})}),!B.ok){const R=await B.json();throw new Error(R.message||"Error al guardar la calificaci√≥n")}p(null),r(!0),setTimeout(()=>{r(!1),C()},1500)}catch(n){console.error("Error guardando calificaci√≥n:",n),m(n instanceof Error?n.message:"Error al guardar la calificaci√≥n")}finally{S(!1)}}},t=a=>a===null?"bg-gray-100 text-gray-800":a>=16?"bg-green-100 text-green-800":a>=13?"bg-blue-100 text-blue-800":a>=11?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",i=a=>{const u={Exam:{label:"Examen",variant:"default"},Project:{label:"Proyecto",variant:"secondary"},Quiz:{label:"Quiz",variant:"outline"},Assignment:{label:"Tarea",variant:"outline"}}[a]||{label:a,variant:"outline"};return e.jsx(_,{variant:u.variant,children:u.label})},x=()=>{const a=h.evaluations.filter(u=>u.obtained_grade!==null).map(u=>parseFloat(u.obtained_grade));if(a.length===0)return null;const n=a.reduce((u,y)=>u+y,0);return parseFloat((n/a.length).toFixed(2))},s=()=>{p(null),m(null),r(!1),f()};return e.jsx(de,{open:b,onOpenChange:s,children:e.jsxs(me,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(xe,{children:[e.jsxs(ue,{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(W,{className:"h-6 w-6"}),"Calificaciones de ",h.name]}),e.jsx(he,{children:l?"Ver y editar calificaciones del estudiante":"Ver tus calificaciones"})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[v&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700 text-sm",children:v})}),N&&e.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4 text-green-600"}),e.jsx("p",{className:"text-green-700 text-sm",children:"¬°Calificaci√≥n guardada exitosamente!"})]}),e.jsx(P,{children:e.jsx($,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Promedio General"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4 text-primary"}),e.jsx(_,{className:`${t(x())} text-lg font-bold`,children:x()||"N/A"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Evaluaciones Completadas"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-4 w-4 text-primary"}),e.jsxs("span",{children:[h.evaluations.filter(a=>a.obtained_grade!==null).length," / ",h.evaluations.length]})]})]})]})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Evaluaciones"}),h.evaluations.map(a=>e.jsxs(P,{children:[e.jsx(Q,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1 flex-1",children:[e.jsx(q,{className:"text-base",children:a.evaluation_title}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[i(a.evaluation_type),e.jsxs(_,{variant:"outline",children:[a.weight," pts"]})]})]}),a.obtained_grade&&!o&&e.jsx(_,{className:`${t(parseFloat(a.obtained_grade))} font-semibold`,children:a.obtained_grade})]})}),e.jsx($,{className:"space-y-3",children:o===a.evaluation_id?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:`grade-${a.evaluation_id}`,className:"text-sm",children:"Calificaci√≥n (0-20)"}),e.jsx(F,{id:`grade-${a.evaluation_id}`,type:"number",step:"0.1",min:"0",max:"20",placeholder:"Ej: 15.5",value:w[a.evaluation_id]?.obtained_grade||"",onChange:n=>g(a.evaluation_id,"obtained_grade",n.target.value),disabled:j})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:`feedback-${a.evaluation_id}`,className:"text-sm",children:"Comentario"}),e.jsx(F,{id:`feedback-${a.evaluation_id}`,placeholder:"Comentario opcional",value:w[a.evaluation_id]?.feedback||"",onChange:n=>g(a.evaluation_id,"feedback",n.target.value),disabled:j})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{size:"sm",onClick:()=>M(a.evaluation_id),disabled:j||!w[a.evaluation_id]?.obtained_grade,children:j?e.jsx(z,{className:"h-4 w-4 animate-spin"}):"Guardar"}),e.jsx(D,{size:"sm",variant:"outline",onClick:()=>p(null),disabled:j,children:"Cancelar"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a.obtained_grade?"Calificaci√≥n asignada":"Sin calificar"}),l&&e.jsxs(D,{size:"sm",variant:"outline",onClick:()=>p(a.evaluation_id),children:[e.jsx(ye,{className:"h-4 w-4 mr-1"}),a.obtained_grade?"Editar":"Agregar"]})]}),a.feedback&&e.jsxs("div",{className:"text-sm text-muted-foreground bg-muted p-2 rounded",children:[e.jsx("strong",{children:"Comentario:"})," ",a.feedback]}),a.record_date&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Registrado: ",new Date(a.record_date).toLocaleDateString("es-PE")]})]})})]},a.evaluation_id))]})]}),e.jsx(pe,{children:e.jsx(D,{onClick:s,children:"Cerrar"})})]})})}function ta({groupId:b,token:f,isTeacher:C,userId:h}){const[E,k]=c.useState([]),[l,w]=c.useState([]),[d,j]=c.useState(!0),[S,v]=c.useState(null),[m,N]=c.useState(null),[r,o]=c.useState(!1);c.useEffect(()=>{p()},[b]);const p=async()=>{if(f){j(!0),v(null);try{const s=f.replace(/^"|"$/g,""),a=`${A.apiUrl}${A.endpoints.grades.getByGroup}`.replace(":groupId",b),n=await fetch(a,{method:"GET",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(!n.ok)throw new Error(`Error al cargar calificaciones: ${n.status}`);const u=await n.json();w(u.evaluations||[]);const y=g(u.evaluations||[]);k(y)}catch(s){console.error("Error cargando calificaciones:",s),v(s instanceof Error?s.message:"Error al cargar calificaciones")}finally{j(!1)}}},g=s=>{const a=new Map;s.forEach(u=>{u.grades.forEach(y=>{a.has(y.student_id)||a.set(y.student_id,{id:y.student_id,name:y.student_name,evaluations:[]}),a.get(y.student_id).evaluations.push({evaluation_id:u.id,evaluation_title:u.title,evaluation_type:u.evaluation_type,weight:u.weight,obtained_grade:y.obtained_grade,feedback:y.feedback,record_date:y.record_date})})});const n=Array.from(a.values());return n.forEach(u=>{const y=u.evaluations.filter(G=>G.obtained_grade!==null).map(G=>parseFloat(G.obtained_grade));if(y.length>0){const G=y.reduce((B,R)=>B+R,0);u.average_grade=parseFloat((G/y.length).toFixed(2))}}),n},M=s=>{N(s),o(!0)},t=()=>{p()},i=s=>s===null?"bg-gray-100 text-gray-800":s>=16?"bg-green-100 text-green-800":s>=13?"bg-blue-100 text-blue-800":s>=11?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",x=s=>s.evaluations.filter(a=>a.obtained_grade!==null).length;return d?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(z,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"text-muted-foreground",children:"Cargando calificaciones..."})]}):S?e.jsxs("div",{className:"text-center py-12 space-y-4",children:[e.jsx("p",{className:"text-red-500 text-lg font-medium",children:S}),e.jsx(D,{onClick:p,children:"Reintentar"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center flex-wrap gap-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Calificaciones del Grupo"}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:[E.length," ",E.length===1?"estudiante":"estudiantes"," en total"]})]})}),E.length===0?e.jsx(P,{className:"text-center py-16",children:e.jsx($,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(_e,{className:"h-16 w-16 text-muted-foreground mx-auto"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-muted-foreground",children:"No hay estudiantes"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"A√∫n no hay estudiantes registrados en este grupo"})]})]})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.map(s=>e.jsxs(P,{className:"hover:shadow-lg transition-all cursor-pointer",onClick:()=>M(s),children:[e.jsx(Q,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs(q,{className:"text-lg flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-primary"}),s.name]}),e.jsxs(fe,{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4"}),x(s),"/",s.evaluations.length," evaluaciones"]})]}),C&&e.jsx(ye,{className:"h-5 w-5 text-muted-foreground flex-shrink-0 mt-1"})]})}),e.jsxs($,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Promedio:"}),s.average_grade!==void 0?e.jsx(_,{className:`${i(s.average_grade)} font-semibold`,children:s.average_grade}):e.jsx(_,{variant:"outline",className:"text-muted-foreground",children:"Sin calificaciones"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Evaluaciones:"}),e.jsxs("div",{className:"space-y-1",children:[s.evaluations.slice(0,3).map(a=>e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"truncate flex-1 mr-2",children:a.evaluation_title}),a.obtained_grade?e.jsx(_,{variant:"outline",className:`${i(parseFloat(a.obtained_grade))} text-xs`,children:a.obtained_grade}):e.jsx(_,{variant:"outline",className:"text-muted-foreground text-xs",children:"Pendiente"})]},a.evaluation_id)),s.evaluations.length>3&&e.jsxs("div",{className:"text-xs text-muted-foreground text-center",children:["+",s.evaluations.length-3," m√°s..."]})]})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{children:"Estado:"}),x(s)===s.evaluations.length?e.jsx(_,{variant:"default",className:"text-xs",children:"Completo"}):e.jsx(_,{variant:"outline",className:"text-xs",children:"En progreso"})]})})]})]},s.id))})]}),m&&e.jsx(sa,{isOpen:r,onClose:()=>o(!1),onGradesUpdated:t,student:m,evaluations:l,token:f,isTeacher:C})]})}function ra({groupId:b,token:f,isTeacher:C=!1}){const[h,E]=c.useState(null),[k,l]=c.useState(!0),[w,d]=c.useState(null),[j,S]=c.useState("");c.useEffect(()=>{v()},[b]);const v=async()=>{if(f){l(!0),d(null);try{const s=f.replace(/^"|"$/g,""),a=`${A.apiUrl}${A.endpoints.groups.getById}`.replace(":id",b);console.log("Cargando datos del grupo desde:",a);const n=await fetch(a,{method:"GET",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(!n.ok)throw new Error(`Error al cargar datos: ${n.status}`);const u=await n.json();console.log("Respuesta de la API:",u),E(u)}catch(s){console.error("Error cargando datos:",s),d(s instanceof Error?s.message:"Error al cargar datos")}finally{l(!1)}}},m=h?.group?.participants?.teacher,N=h?.group?.participants?.students||[],r=N.filter(s=>s.full_name?.toLowerCase().includes(j.toLowerCase())||s.email?.toLowerCase().includes(j.toLowerCase())||s.dni?.toLowerCase().includes(j.toLowerCase())),o=s=>{const n={teacher:{label:"Docente",variant:"default",icon:e.jsx(re,{className:"h-3 w-3 mr-1"})},student:{label:"Estudiante",variant:"outline"}}[s]||{label:s,variant:"outline"};return e.jsxs(_,{variant:n.variant,className:"flex items-center gap-1",children:[n.icon,n.label]})},p=s=>{const n={active:{label:"Activo",variant:"default"},inactive:{label:"Inactivo",variant:"outline"},completed:{label:"Completado",variant:"default"},scheduled:{label:"Programado",variant:"secondary"},cancelled:{label:"Cancelado",variant:"destructive"}}[s]||{label:s,variant:"outline"};return e.jsx(_,{variant:n.variant,children:n.label})},g=(s,a)=>`${s?.[0]||""}${a?.[0]||""}`.toUpperCase(),M=s=>s==="female"?e.jsx(Oe,{className:"h-3 w-3"}):e.jsx(He,{className:"h-3 w-3"}),t=s=>{const a=new Date(s),n=new Date;let u=n.getFullYear()-a.getFullYear();const y=n.getMonth()-a.getMonth();return(y<0||y===0&&n.getDate()<a.getDate())&&u--,u},i=()=>{console.log("Agregar nuevo participante")},x=s=>{console.log("Enviar mensaje a:",s.full_name)};return k?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(z,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"text-muted-foreground",children:"Cargando participantes..."})]}):w?e.jsxs("div",{className:"text-center py-12 space-y-4",children:[e.jsx("p",{className:"text-red-500 text-lg font-medium",children:w}),e.jsx(D,{onClick:v,children:"Reintentar"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Participantes del Grupo"}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:[1+N.length," ",1+N.length===1?"participante":"participantes"," en total"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full sm:w-auto",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(F,{placeholder:"Buscar participantes...",value:j,onChange:s=>S(s.target.value),className:"pl-10 w-full sm:w-64"})]}),C&&e.jsxs(D,{onClick:i,className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),"Agregar"]})]})]}),h?.group&&e.jsx(P,{className:"bg-muted/50",children:e.jsx($,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:h.group.name}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsxs("span",{children:[new Date(h.group.start_date).toLocaleDateString("es-PE")," - ",new Date(h.group.end_date).toLocaleDateString("es-PE")]})]}),e.jsxs("div",{children:["Estado: ",e.jsx(_,{variant:"outline",children:p(h.group.status)})]})]})]}),e.jsx(_,{variant:"outline",className:"text-sm",children:h.group.status})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(P,{children:e.jsx($,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold",children:1+N.length})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(se,{className:"h-6 w-6 text-blue-600"})})]})})}),e.jsx(P,{children:e.jsx($,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Docentes"}),e.jsx("p",{className:"text-2xl font-bold",children:m?1:0})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(re,{className:"h-6 w-6 text-green-600"})})]})})}),e.jsx(P,{children:e.jsx($,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Estudiantes"}),e.jsx("p",{className:"text-2xl font-bold",children:N.length})]}),e.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:e.jsx(W,{className:"h-6 w-6 text-orange-600"})})]})})})]}),m&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5 text-yellow-600"}),e.jsx("h3",{className:"text-xl font-semibold",children:"Docente"}),e.jsx(_,{variant:"outline",className:"ml-2",children:"1"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.jsx(P,{className:"hover:shadow-md transition-shadow",children:e.jsx($,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs(le,{className:"h-12 w-12 border-2 border-yellow-200",children:[e.jsx(ne,{src:m.profile_photo||""}),e.jsx(ie,{className:"bg-yellow-100 text-yellow-800",children:g(m.first_name,m.last_name)})]}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"flex items-start justify-between gap-2",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold truncate",children:m.full_name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o("teacher"),p(m.status)]})]})})})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Z,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:m.email})]}),m.phone_number&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(je,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:m.phone_number})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ce,{className:"h-4 w-4 flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:[m.country_location,", ",m.country]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[M(m.gender),e.jsxs("span",{children:[m.gender==="male"?"Hombre":"Mujer"," ‚Ä¢ ",t(m.birth_date)," a√±os"]})]}),m.dni&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["DNI: ",m.dni]})]}),e.jsx("div",{className:"flex gap-2 pt-2",children:e.jsxs(D,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>x(m),children:[e.jsx(Z,{className:"h-4 w-4 mr-1"}),"Mensaje"]})})]})})})})]}),N.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"text-xl font-semibold",children:"Estudiantes"}),e.jsx(_,{variant:"outline",className:"ml-2",children:r.length})]}),r.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(s=>e.jsx(P,{className:"hover:shadow-md transition-shadow",children:e.jsx($,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs(le,{className:"h-12 w-12 border-2 border-blue-200",children:[e.jsx(ne,{src:s.profile_photo||""}),e.jsx(ie,{className:"bg-blue-100 text-blue-800",children:g(s.first_name,s.last_name)})]}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"flex items-start justify-between gap-2",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold truncate",children:s.full_name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o("student"),p(s.status)]})]})})})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Z,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.email})]}),s.phone_number&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(je,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:s.phone_number})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ce,{className:"h-4 w-4 flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:[s.country_location,", ",s.country]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[M(s.gender),e.jsxs("span",{children:[s.gender==="male"?"Hombre":"Mujer"," ‚Ä¢ ",t(s.birth_date)," a√±os"]})]}),s.dni&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["DNI: ",s.dni]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Registrado el ",new Date(s.created_at).toLocaleDateString("es-PE")]}),C&&e.jsx("div",{className:"flex gap-2 pt-2",children:e.jsxs(D,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>x(s),children:[e.jsx(Z,{className:"h-4 w-4 mr-1"}),"Mensaje"]})})]})})},s.id))}):e.jsx(P,{className:"text-center py-8",children:e.jsxs($,{children:[e.jsx(ge,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-muted-foreground",children:"No se encontraron estudiantes"}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:['No hay resultados para "',j,'"']}),e.jsx(D,{variant:"outline",onClick:()=>S(""),className:"mt-4",children:"Limpiar b√∫squeda"})]})})]}),!m&&N.length===0&&e.jsx(P,{className:"text-center py-16",children:e.jsxs($,{children:[e.jsx(se,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-muted-foreground",children:"No hay participantes"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:C?"Comienza agregando participantes al grupo":"A√∫n no hay participantes en este grupo"}),C&&e.jsxs(D,{onClick:i,className:"mt-4",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Agregar Primer Participante"]})]})})]})}function la({groupId:b,token:f,isTeacher:C}){const[h,E]=c.useState([]),[k,l]=c.useState(!0),[w,d]=c.useState(null);c.useEffect(()=>{j()},[b]);const j=async()=>{if(f){l(!0),d(null);try{const r=f.replace(/^"|"$/g,""),o=`${A.apiUrl}${A.endpoints.classes.getByGroup}`.replace(":groupId",b),p=await fetch(o,{method:"GET",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(!p.ok)throw new Error(`Error al cargar clases: ${p.status}`);const g=await p.json();E(g.classes||g||[])}catch(r){console.error("Error cargando clases:",r),d(r instanceof Error?r.message:"Error al cargar clases")}finally{l(!1)}}},S=(r,o)=>{try{const p=`${r.split("T")[0]}T${o.split("T")[1]||o}`,g=new Date(p),M=g.toLocaleDateString("es-PE",{weekday:"short",day:"2-digit",month:"short",year:"numeric"}),t=g.toLocaleTimeString("es-PE",{hour:"2-digit",minute:"2-digit",hour12:!0});return{date:M,time:t,fullDate:g.toLocaleDateString("es-PE",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}}catch(p){return console.error("Error formateando fecha:",p),{date:"Fecha inv√°lida",time:"Hora inv√°lida",fullDate:"Fecha inv√°lida"}}},v=(r,o)=>{try{const p=new Date(r),M=new Date(o).getTime()-p.getTime(),t=Math.floor(M/(1e3*60*60)),i=Math.floor(M%(1e3*60*60)/(1e3*60));return t>0?`${t}h ${i>0?`${i}m`:""}`:`${i}m`}catch{return"Duraci√≥n no disponible"}},m=r=>{const p={scheduled:{label:"Programada",variant:"default",color:"bg-blue-100 text-blue-800 border-blue-200"},in_progress:{label:"En Progreso",variant:"secondary",color:"bg-green-100 text-green-800 border-green-200"},completed:{label:"Completada",variant:"outline",color:"bg-gray-100 text-gray-800 border-gray-200"},cancelled:{label:"Cancelada",variant:"destructive",color:"bg-red-100 text-red-800 border-red-200"}}[r.toLowerCase()]||{label:r,variant:"outline",color:"bg-gray-100 text-gray-800 border-gray-200"};return e.jsx(_,{variant:p.variant,className:`${p.color} font-medium`,children:p.label})},N=[...h].sort((r,o)=>new Date(o.class_date).getTime()-new Date(r.class_date).getTime());return k?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(z,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"text-muted-foreground",children:"Cargando clases..."})]}):w?e.jsxs("div",{className:"text-center py-12 space-y-4",children:[e.jsx("p",{className:"text-red-500 text-lg font-medium",children:w}),e.jsx(D,{onClick:j,className:"mt-4",children:"Reintentar"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center flex-wrap gap-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Clases Programadas"}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:[N.length," ",N.length===1?"clase":"clases"," en total"]})]})}),N.length===0?e.jsx(P,{className:"text-center py-16",children:e.jsxs($,{className:"space-y-4",children:[e.jsx(H,{className:"h-12 w-12 text-muted-foreground mx-auto"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-muted-foreground",children:"No hay clases programadas"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:C?"Comienza programando la primera clase del grupo":"A√∫n no hay clases programadas para este grupo"})]})]})}):e.jsx("div",{className:"grid gap-4",children:N.map(r=>{const o=S(r.class_date,r.start_time),p=S(r.class_date,r.end_time),g=v(r.start_time,r.end_time);return e.jsxs(P,{className:"hover:shadow-md transition-shadow",children:[e.jsx(Q,{className:"pb-3",children:e.jsx("div",{className:"flex justify-between items-start gap-4",children:e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs(q,{className:"text-xl flex items-center gap-2",children:[e.jsx(H,{className:"h-5 w-5 text-primary"}),r.class_name]}),m(r.class_status)]}),r.description&&e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:r.description})]})})}),e.jsx($,{className:"pb-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(L,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:o.fullDate}),e.jsxs("p",{className:"text-muted-foreground",children:[o.time," - ",p.time," ‚Ä¢ ",g]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:r.meeting_url?e.jsx(H,{className:"h-5 w-5 text-blue-600"}):e.jsx(ce,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r.meeting_url?"Clase Virtual":r.location||"Presencial"}),e.jsx("p",{className:"text-muted-foreground",children:r.meeting_url?"Enlace disponible":r.location?"Ubicaci√≥n espec√≠fica":"Por definir"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(se,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Estado"}),e.jsx("div",{className:"mt-1",children:m(r.class_status)})]})]})]})}),e.jsx(ve,{className:"pt-0",children:r.meeting_url&&e.jsx(D,{asChild:!0,className:"w-full md:w-auto",variant:"default",children:e.jsxs("a",{href:r.meeting_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),"Unirse a la Clase"]})})})]},r.id)})})]})}function na({user:b,token:f}){const[C,h]=c.useState("anuncios"),[E,k]=c.useState(!0),[l,w]=c.useState(null),d=b?.role==="teacher"||b?.role==="docente",j=typeof window<"u"&&new URLSearchParams(window.location.search).get("groupId")||"1";c.useEffect(()=>{S()},[j]);const S=async()=>{if(f){k(!0);try{const v=f.replace(/^"|"$/g,""),m=`${A.apiUrl}${A.endpoints.groups.getById}`.replace(":id",j),N=await fetch(m,{method:"GET",headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json"}});if(!N.ok)throw new Error(`Error al cargar el grupo: ${N.status}`);const r=await N.json(),o=r.group||r;w({id:o.id,name:o.name,courseName:o.course?.name||o.description||"Sin nombre de curso",teacherName:o.participants?.teacher?.full_name||`${o.participants?.teacher?.first_name} ${o.participants?.teacher?.last_name}`||"Sin docente asignado",teacherPhoto:o.participants?.teacher?.profile_photo||"/academico/images/9440461.webp",startDate:o.start_date,endDate:o.end_date})}catch(v){console.error("Error cargando datos del grupo:",v)}finally{k(!1)}}};return E?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx(z,{className:"h-8 w-8 animate-spin text-primary"})}):l?e.jsxs("div",{className:"w-full space-y-6 p-4 md:p-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold",children:l?.name}),e.jsx("p",{className:"text-muted-foreground text-lg",children:l?.courseName}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(le,{className:"h-8 w-8",children:[e.jsx(ne,{src:l?.teacherPhoto}),e.jsx(ie,{children:l?.teacherName?.split(" ").map(v=>v[0]).join("").slice(0,2)})]}),e.jsx("span",{className:"text-sm",children:l?.teacherName})]})]}),e.jsxs(Me,{value:C,onValueChange:h,className:"w-full",children:[e.jsxs(Te,{className:"grid w-full grid-cols-5 h-auto",children:[e.jsxs(O,{value:"anuncios",className:"gap-2 flex-col sm:flex-row py-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Anuncios"})]}),e.jsxs(O,{value:"evaluaciones",className:"gap-2 flex-col sm:flex-row py-2",children:[e.jsx(Ve,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Evaluaciones"})]}),e.jsxs(O,{value:"calificaciones",className:"gap-2 flex-col sm:flex-row py-2",children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Calificaciones"})]}),e.jsxs(O,{value:"participantes",className:"gap-2 flex-col sm:flex-row py-2",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Participantes"})]}),e.jsxs(O,{value:"clases",className:"gap-2 flex-col sm:flex-row py-2",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Clases"})]})]}),e.jsx(U,{value:"anuncios",className:"mt-6",children:e.jsx(Xe,{groupId:j,token:f,isTeacher:d,teacherId:b.id})}),e.jsx(U,{value:"evaluaciones",className:"mt-6",children:e.jsx(aa,{groupId:j,token:f,isTeacher:d,teacherId:b.id})}),e.jsx(U,{value:"calificaciones",className:"mt-6",children:e.jsx(ta,{groupId:j,token:f,isTeacher:d,userId:b?.id})}),e.jsx(U,{value:"participantes",className:"mt-6",children:e.jsx(ra,{groupId:j,token:f})}),e.jsx(U,{value:"clases",className:"mt-6",children:e.jsx(la,{groupId:j,token:f,isTeacher:d})})]})]}):e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("p",{className:"text-muted-foreground",children:"No se pudo cargar la informaci√≥n del grupo"})})}function Da(){const[b,f]=c.useState(null),[C,h]=c.useState(null),[E,k]=c.useState(!1);return c.useEffect(()=>{const l=window.localStorage.getItem("token"),w=window.localStorage.getItem("user");console.log(l),f(l??null);try{h(w?JSON.parse(w):null)}catch{h(null)}k(!0)},[]),E?e.jsxs(Ee,{style:{"--sidebar-width":"calc(var(--spacing) * 72)","--header-height":"calc(var(--spacing) * 12)"},children:[e.jsx(ke,{variant:"inset",token:b,user:C}),e.jsxs(Se,{children:[e.jsx(De,{title:"Gesti√≥n de Grupos"}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx("div",{className:"@container/main flex flex-1 flex-col gap-2",children:e.jsx(na,{user:C,token:b})})})]})]}):null}export{Da as default};
